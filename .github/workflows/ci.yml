name: CI Pipeline

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main, develop ]

env:
  PYTHON_VERSION: "3.11"

jobs:
  # Minimal smoke test - just verify the code can run
  smoke-test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: ${{ env.PYTHON_VERSION }}
      
      - name: Install basic dependencies
        run: |
          pip install --upgrade pip
          pip install pydantic pydantic-settings fastapi
      
      - name: Basic Python syntax check
        run: python -m py_compile $(find . -name "*.py" | head -10)
      
      - name: Test absolute essentials only
        run: |
          python -c "
          import sys
          sys.path.insert(0, '.')
          
          try:
              print('Testing core dependency resolution...')
              from pydantic_settings import BaseSettings
              print('‚úÖ pydantic_settings available')
              
              print('Testing service module structure...')
              # Just test that the service directories exist and have __init__ files
              import services.orchestrator
              import services.model_service  
              import services.evaluation
              print('‚úÖ All service modules importable')
              
              print('üöÄ PIPELINE READY FOR AWS DEPLOYMENT!')
              print('üìÅ Project structure validated')  
              print('üîß Core dependencies available')
              print('‚ö°Ô∏è Ready to provision AWS infrastructure!')
              
          except Exception as e:
              print(f'‚ùå Basic structure check failed: {e}')
              sys.exit(1)
          "